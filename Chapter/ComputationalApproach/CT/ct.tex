\documentclass[../../../main.tex]{subfiles}
\begin{document}
\subsection{Introduction}
\begin{enumerate}
    \item \textbf{Attenuation coefficient.} A material property that quantifies how strongly the material absorbs or scatters X-rays. Units: $\text{cm}^{-1}$. It is the physical quantity reconstructed in CT imaging.
    \item \textbf{Intensity.} $I_0$: the incident X-ray intensity before passing through the object (air scan).  $I$: the transmitted X-ray intensity measured by the detector.
    \item \textbf{Projection.} The set of attenuation measurements collected at one fixed rotation angle of the source--detector system. It corresponds mathematically to line integrals of $\mu(x,y)$ along rays oriented at that angle.
    \item \textbf{Ray / Line integral.} Each individual X-ray path through the object. The measured attenuation for one ray is proportional to the integral of $\mu$ along its path.
    \item \textbf{Detector element (bin).} A single sensor in the detector array that records X-ray intensity for one ray. Multiple bins together form the projection profile for a given angle.
    \item \textbf{Projection profile (absorption profile).} The one-dimensional array of attenuation values for all detector bins at a given projection angle. Also called line profile.
    \item \textbf{Sinogram.} The two-dimensional array formed by stacking projection profiles for all angles. Dimension: number of detector bins ($N_s$) $\times$ number of projection angles ($N_\theta$).
    \item \textbf{View / Angle.} One orientation of the X-ray source and detector around the object. Each view corresponds to one projection.
    \item \textbf{Field of view (FOV).} The maximum circular cross-section of the object that can be fully imaged, determined by the geometry of the source and detector.
    \item \textbf{Reconstruction.} The mathematical process of recovering $\mu(x,y)$, i.e. the attenuation map of the object, from the sinogram. Methods include filtered backprojection and iterative reconstruction.
    \item \textbf{Pixel / Voxel.} Pixel: one element of the reconstructed 2D CT image. Voxel: the 3D analogue when slices are stacked.
\end{enumerate}

\subsection{Conventional Radiography and CT}
In conventional radiography, the image represents a 2D projection of the anatomical structures along the direction of the X-ray beam.
Consequently, no true depth or slice information can be extracted.

In contrast, CT employs a rotating X-ray source and a detector array that acquire multiple projections of the object from different angles.
These projections are then processed mathematically.
Each pixel in a CT image corresponds to a specific volumetric element (voxel) with a defined X-ray attenuation coefficient, allowing three-dimensional representation and quantitative measurement of tissue density.

Here are few reason why CT is prefered.
\begin{enumerate}
    \item Improve contrast to enable visualization of different types of soft tissue with X-ray energies.
    \item Enable 3D visualization.
    \item Visualization of a slice of the anatomy along any imaging plane.
\end{enumerate}

The reason CT visualization is generaly better tha conventional radiography is because the attenuation coefficients of most soft tissues are very similar at diagnostic X-ray energies, radiographs exhibit poor soft tissue contrast.
Dense materials such as bone or metal absorb X-rays much more strongly, thereby dominating the image contrast and obscuring the visualization of low-density structures such as blood vessels, muscle, or internal organ boundaries.
Consequently, structures composed primarily of soft tissue—such as the heart, liver, or vasculature—are not well distinguished in conventional X-ray images.
CT overcomes this limitation by reconstructing thin slices, thus eliminating superposition of overlying structures and allows the detection of small differences in attenuation between soft tissues.

\subsection{Beer's Law}
The general form of Beer’s law describes how a beam of radiation is attenuated as it propagates through an absorbing medium.
In three-dimensional space, when the attenuation coefficient is not constant but varies with position, the law generalizes to a path integral form
\begin{equation*}
    I=I_0\exp \left( -\int_S \mu(\mathbf{r })\;ds \right)
\end{equation*}

To obtain a form suitable for tomographic reconstruction, one takes the natural logarithm and rearranges
\begin{equation*}
    \ln\!\left(\frac{I_0}{I}\right) = \int_{S} \mu(\mathbf{r}) \; ds.
\end{equation*}
The left-hand side is experimentally measurable, since $I$ and $I_0$ are detector readings.
The right-hand side is the line integral of the attenuation coefficient along the X-ray path
Defining the projection function $p(r,\theta)$, one obtains
\begin{equation*}
    p_\theta(r)    = \int_{S} \mu(x,y) \; ds,
\end{equation*}
where $\theta$ is the projection angle and $r$ denotes the detector position.

\subsection{Rodon Transform}
The Radon transform describes how a two-dimensional function, such as the attenuation coefficient distribution $\mu(x,y)$, is projected onto a set of line integrals at various angular orientations.

\begin{figure*}
    \centering
    \normfig{../../../Rss/ComputationalApproach/CT/ParallelBeam.png}
    \caption*{Figure: Parallel Beam}
\end{figure*}

Consider parallel-beam geometry with attenuated intensity of $I_0$.
A new coordinate system is defined by rotating $(x,y)$ counterclockwise over the angle $\theta$, which given by the transformation of
\begin{equation*}
    \begin{bmatrix}
        x \\y
    \end{bmatrix}
    =
    \begin{bmatrix}
        \cos \theta & -\sin \theta \\
        \sin \theta & \cos \theta  \\
    \end{bmatrix}
    \begin{bmatrix}
        r \\s
    \end{bmatrix}
    \quad \text{or }\quad
    \begin{bmatrix}
        r \\s
    \end{bmatrix}
    =
    \begin{bmatrix}
        \cos \theta  & \sin \theta \\
        -\sin \theta & \cos \theta \\
    \end{bmatrix}
    \begin{bmatrix}
        x \\y
    \end{bmatrix}
\end{equation*}
For a fixed angle $\theta$ the measured intensity profile as a function of $r$ is given by
\begin{align*}
    I_\theta(r) & = I_0 \exp \left[ -\sum_s f(x,y)\Delta s \right]                                                                    \\
    I_\theta(r) & = I_0 \exp \left[ -\sum_s f \left( r \cos \theta-s \sin \theta,r \sin \theta+s \cos \theta \right) \Delta s \right]
\end{align*}
For each measured intensity, we can compute the corresponding attenuation line sum.
Each intensity profile is then transformed into an attenuation profile as
\begin{equation*}
    p_\theta(r)=-\ln \left(  \frac{I_0(r )}{I_0}\right)
\end{equation*}
with $p_\theta(r)$ as the projection function of the function $(x,y)$ along the angle $\theta$.
It can also be understood that
\begin{equation*}
    p_\theta(r)=\sum_s f \left( r \cos \theta-s \sin \theta,r \sin \theta+s \cos \theta \right) \Delta s
\end{equation*}
Stacking all the projections $p_\theta(r)$ together results in a 2D data set $p(r,\theta)$ which is called a sinogram.
\begin{equation*}
    p(r,\theta)=\begin{cases}
        p_0(r),               & \theta=0             \\
        p_{\Delta\theta}(r),  & \theta=\Delta\theta  \\
        p_{2\Delta\theta}(r), & \theta=2\Delta\theta \\
        \vdots
    \end{cases}
\end{equation*}
In other words, you get the sinogram by plotting $p(r,\theta)$ with $r$ in the $x$ axis and $\theta$ in the $y$ axis.

The transformation of a function $f(x,y)$ into the sinogram $p(r,\theta)$ is called the Radon transform.
\begin{equation*}
    p(r,\theta)=R \left[ f(x,y) \right]=\sum_s f \left( r \cos \theta-s \sin \theta,r \sin \theta+s \cos \theta \right) \Delta s
\end{equation*}

\subsection{Sampling}
In practice, the sinogram $p(r,\theta)$ given by the Rodon transformation becomes $p(n\Delta  r,m\Delta\theta)$ with $M$ rows and $N$ columns.

The minimum number of detector samples required to prevent distortion due to aliasing is called the Nyquist criterion.
It states that if $\Delta s$ is the beam width, then the maximum sampling distance is $\Delta s/2$, or at least two samples per beam width are required.
The spatial frequency is then
\begin{equation*}
    k_N = \frac{1 }{2\Delta s}
\end{equation*}

A general rule is followed that states that the number of views should be $\pi/2$ times the number of detector samples
For example, if the field of view is 50 cm and the beam width is 1 cm, then 100 detector samples and 150 views are required.

\subsection{Data Acquisition in Translation-Rotation}
\begin{enumerate}
    \item \textbf{Calibration.} Measure the detector intensity without the object for every detector position; denote this as $I_0(r)$.
    \item \textbf{Discretization.} Choose the number of detector samples (translations) per projection $N_s$ and the number of projection angles $N_\theta$. Fix sampling step $\Delta r$ along the detector direction and angular step $\Delta \theta$.
    \item \textbf{Acquisition.} For each angle $\theta_j$, with $j=1,\dots,N_\theta$, perform:
          \begin{enumerate}
              \item Ensure the source–detector pair is at angle $\theta_j$
              \item Translate (or read the detector array) along $r$ axis to obtain measured intensity $I(r_i,\theta_j)$ for each detector samples $r_i$, with $i=1,\dots,N_s$.
              \item Store the corrected detector readings.
          \end{enumerate}
    \item \textbf{Projection profile.} Apply negative logarithm to linearize the Beer–Lambert relation
          \begin{equation*}
              p(r_i,\theta_j)=-\ln \left( \frac{I(r_i,\theta_j)}{I_0(r)} \right)
          \end{equation*}
          This quantity equals the line integral of the attenuation coefficient along the ray
          \begin{equation*}
              p(r_i,\theta_j)
              = \int_{S} \mu(x,y) \; ds,
          \end{equation*}
    \item \textbf{Sinogram.} Assemble all values $p(r_i,\theta_j)$ into a two-dimensional matrix $S$ with rows for detector positions $\theta_i$ and columns for projection angles $\theta_j$. Visualizing this matrix produces the sinogram. The sinogram matrix has dimensions
          \begin{equation*}
              \dim (S)=N_s\times N_\theta
          \end{equation*}
          where $N_s$ is the number of detector samples per projection and $N_\theta$ is the number of projection angles.
\end{enumerate}

\subsection{Brute Force Reconstruction}
Image reconstruction is the process of estimating an image $f(x,y)$ from from a set of projections $p(r,\theta)$.
With this method, the projection set defines a system of simultaneous linear equations that in theory can be solved using algorithms from linear algebra.

\subsubsection{Example.}
Consider the following 2x2 image with 6 projections
\begin{equation*}
    \begin{matrix}
           & w  & x & 12 \\
           & y  & z & 8  \\
        13 & 11 & 9 & 7
    \end{matrix}
\end{equation*}
These can be organized into a system of equations
\begin{equation*}
    \begin{bmatrix}
        1 & 1 & 0 & 0 \\
        0 & 0 & 1 & 1 \\
        1 & 0 & 1 & 0 \\
        0 & 1 & 0 & 1 \\
        1 & 0 & 0 & 1 \\
        0 & 1 & 1 & 0
    \end{bmatrix}
    \begin{bmatrix}
        w \\ x \\ y \\ z
    \end{bmatrix}
    =
    \begin{bmatrix}
        12 \\ 8 \\ 11 \\ 9 \\ 7 \\ 13
    \end{bmatrix}
\end{equation*}
This is an over-determined system of equations; there are 5 equations and 4 unknowns.
As a consequence, some of the rows and columns are linearly dependent.
We can solve it using normal equation
\begin{equation*}
    \Omega^T \Omega \mathbf{x}=\Omega^T W
\end{equation*}
In python, we can use
\begin{minted}[breaklines]{python}
Omega_T_Omega = Omega.T @ Omega
Omega_T_W = Omega.T @ W
\end{minted}
to reproduce $\Omega^T \Omega$ and $\Omega^T W$.
Specifically, \verb|Omega.T| is the transpose of \verb|Omega| and \verb|@| denotes matrix multiplication.
Also, since the matrix is initialized with \verb|numpy| array, the operation is also handled by \verb|numpy|
\begin{minted}[breaklines]{python}
Omega = np.array([...], dtype=float)
W = np.array([...], dtype=float)
\end{minted}

\subsection{Iterative Reconstruction Reconstruction}
The iterative reconstruction (also known as algebraic reconstruction technique-ART) consists of three steps:
\begin{enumerate}
    \item Make an initial guess at the solution
    \item Compute projections based on the guess
    \item Refine the guess based on the weighted difference between the actual projections and the desired projections $p^{i+1}=p^i+g(\text{desired}-\text{actual})$
\end{enumerate}
The ART was the original reconstruction method used in medical imaging.
The method works, but is slow and susceptible to noise. With more noise, the convergence is very slow, and is not guaranteed.

\subsubsection{Example.}
Consider the same 2x2 image with 6 projections
\begin{equation*}
    \begin{matrix}
           & w  & x & 12 \\
           & y  & z & 8  \\
        13 & 11 & 9 & 7
    \end{matrix}
\end{equation*}
First let us make initial guess of zero
\begin{equation*}
    \begin{matrix}
          & 0 & 0 & 0 \\
          & 0 & 0 & 0 \\
        0 & 0 & 0 & 0
    \end{matrix}
\end{equation*}
Then, let us refine the horizontal estimates with $g=1/2$
\begin{equation*}
    \begin{bmatrix}
        w \\ x \\ y \\ z
    \end{bmatrix}
    =
    \begin{bmatrix}
        0 + \dfrac{(12 - 0)}{2} \\
        0 + \dfrac{(12 - 0)}{2} \\
        0 + \dfrac{(8 - 0)}{2}  \\
        0 + \dfrac{(8 - 0)}{2}
    \end{bmatrix}
    =
    \begin{bmatrix}
        6 \\ 6 \\ 4 \\ 4
    \end{bmatrix}
\end{equation*}
which yield
\begin{equation*}
    \begin{matrix}
           & 6  & 6  & 12 \\
           & 4  & 4  & 8  \\
        10 & 10 & 10 & 10
    \end{matrix}
\end{equation*}

Next, let us refine the vertical estimates
\begin{equation*}
    \begin{bmatrix}
        w \\ x \\ y \\ z
    \end{bmatrix}
    =
    \begin{bmatrix}
        6 + \dfrac{(11 - 10)}{2} \\
        6 + \dfrac{(9 - 10)}{2}  \\
        4 + \dfrac{(11 - 10)}{2} \\
        4 + \dfrac{(9 - 10)}{2}
    \end{bmatrix}
    =
    \begin{bmatrix}
        6.5 \\ 5.5 \\ 4.5 \\ 3.5
    \end{bmatrix}
\end{equation*}
which yield
\begin{equation*}
    \begin{matrix}
           & 6.5 & 6.5 & 13 \\
           & 4.5 & 3.5 & 8  \\
        10 & 11  & 9   & 10
    \end{matrix}
\end{equation*}

Next, let us refine the diagonal estimates
\begin{equation*}
    \begin{bmatrix}
        w \\ x \\ y \\ z
    \end{bmatrix}
    =
    \begin{bmatrix}
        6.5 + \dfrac{(7 - 10)}{2}  \\
        5.5 + \dfrac{(13 - 10)}{2} \\
        4.5 + \dfrac{(13 - 10)}{2} \\
        3.5 + \dfrac{(7 - 10)}{2}
    \end{bmatrix}
    =
    \begin{bmatrix}
        5 \\ 7 \\ 6 \\ 2
    \end{bmatrix}
\end{equation*}
Now image data and projections match
\begin{equation*}
    \begin{matrix}
           & 5  & 7 & 12 \\
           & 6  & 2 & 8  \\
        13 & 11 & 9 & 7
    \end{matrix}
\end{equation*}

\subsection{Fourier Reconstruction}
In practice, re-sampling from polar to rectangular coordinates involves considerable interpolation, which makes the resultant estimate of $f(x,y)$ noisy and unacceptable for clinical diagnostic purposes.
There are two work around, first using smaller $\Delta s$ and $\Delta \theta$, and the second is using filtered backprojection method.

\begin{enumerate}
    \item \textbf{1D Fourier transform.} For each projection \( p_\theta(r) \), compute its one-dimensional Fourier transform with respect to the detector coordinate \( r \):
          \[
              P_\theta(k) = \int_{-\infty}^{\infty} p_\theta(r)\; e^{-i 2 \pi k r}\; dr.
          \]
          Each resulting \( P_\theta(k) \) represents the frequency content of the projection at angle \( \theta \).

    \item \textbf{2D Fourier transform.} The data \( P_\theta(k) \) are placed in the frequency domain on a polar grid defined by \( (k, \theta) \), forming \( P(k,\theta) \).

    \item \textbf{Interpolation.} The frequency data are then resampled or interpolated from this polar grid \( P(k,\theta) \) onto a Cartesian grid \( F(k_x, k_y) \). This step is justified by central slice theorem, which state
          \begin{equation*}
              P(k,\theta)=F(k_x,k_y)
          \end{equation*}

    \item \textbf{2D Inverse Fourier transform.} Finally, the two-dimensional inverse Fourier transform is applied to \( F(k_x, k_y) \) to reconstruct the spatial domain image \( f(x,y) \)
          \[
              f(x,y) = \iint F(k_x, k_y)\; e^{i 2 \pi (k_x x + k_y y)}\; dk_x\; dk_y.
          \]
\end{enumerate}
\begin{figure*}
    \centering
    \normfigL{../../../Rss/ComputationalApproach/CT/sampling.png}
    \caption*{Figure: Sampling grid, polar and cartesian}
\end{figure*}

\subsection{Backprojection Reconstruction}
This method is inferior to the filtered backprojection, as it produces a blurred image, because each projection is “smeared” along the line.
The algorithm is composed only taking $p_\theta$ and plugging it into
\begin{equation*}
    f_b(x,y)=\int_{0 }^{\pi}\int_{-\infty}^{\infty} p_\theta(r)\delta(x\cos\theta+y\sin\theta -r)\;dr\;d\theta
\end{equation*}

\subsubsection{Derivation.}
Mathematically the back projection of a single measured projection along an unknown density is given by
\begin{equation*}
    b_\theta(x,y)=\int_{-\infty}^{\infty} p_\theta(r)\delta(x\cos\theta+y\sin\theta -r)\;dr
\end{equation*}
The $    b_\theta(x,y)$ is the back-projected density due to the projection $p_\theta(r)$ and the  Dirac delta function signify that the integration is performed in the beam path.
The this is due to the Dirac delta function enforces that only those spatial points receive contributions from the measured value $p_\theta(r)$.

Adding up these densities at all angles, we obtain the laminogram
\begin{equation*}
    f_b(x,y)=\int_{0 }^{\pi} b_\theta(x,y)\;d\theta=\int_{0 }^{\pi}\int_{-\infty}^{\infty} p_\theta(r)\delta(x\cos\theta+y\sin\theta -r)\;dr\;d\theta
\end{equation*}
which represents a distorted picture of the anatomy through which the X-ray beam passes.

The blurring is caused by impulse response of the unfiltered backprojection operator
\begin{equation*}
    f_b(x,y)=f(x,y)*\frac{1 }{r}
\end{equation*}
This $1/r$ dependence explains the blurring inherent to simple backprojection: rather than reconstructing a sharp delta at the origin, the algorithm produces a radially decaying intensity.

To obtain a sharper and quantitatively accurate reconstruction, one applies a filter (usually a ramp filter in the frequency domain) to each projection before or during backprojection.

\subsection{Filtered Backprojection Reconstruction}
Essentialy, this formula
\begin{equation*}
    f(x,y) = \int_{0}^{2\pi}\int_{-\infty }^{\infty}\mathcal{F} \left\{ p_\theta(r) \right\} |k| \exp \left[{i 2\pi k (x\cos\theta + y\sin\theta)}\right] \; dk \; d\theta
\end{equation*}
The algorithm, however, is as follows.
\begin{enumerate}
    \item \textbf{Fourier transform of each projection.}
          For each projection $p_\theta(r)$ compute its one-dimensional Fourier transform with respect to $r$
          \[
              P_{\theta}(k) = \mathcal{F}\{p_{\theta}(r)\}
              = \int_{-\infty}^{\infty} p_{\theta}(r)\, e^{-i2\pi kr}\,dr.
          \]
          with $H(k)=|k|$ frequency-domain filter.

    \item \textbf{Frequency-domain filtering (ramp filter).} Multiply each transformed projection by the ramp filter $|k|$
          \[
              \tilde{P}_{\theta}(k) = |k|\, P_{\theta}(k).
          \]

    \item \textbf{Inverse transform to spatial domain.}
          Perform the inverse one-dimensional Fourier transform to obtain the filtered projection
          \[
              \tilde{p}_{\theta}(r) = \mathcal{F}^{-1}\{\tilde{P}_{\theta}(k)\}
              = \int_{-\infty}^{\infty} \tilde{P}_{\theta}(k)\, e^{i2\pi kr}\,dk.
          \]

    \item \textbf{Backprojection.} Reconstruct the image by integrating all filtered projections over the angular range
          \[
              f(x,y) = \int_{0}^{\pi}
              \tilde{p}_{\theta}(x\cos\theta + y\sin\theta)\, d\theta.
          \]
\end{enumerate}

We begin by restating the back-projection relationship for the laminogram
\begin{equation*}
    f_b(x,y)=\int_{0 }^{\pi}\int_{-\infty}^{\infty} p(r,\theta)\delta(x\cos\theta+y\sin\theta -r)\;dr\;d\theta
\end{equation*}
where we have used $p_\theta(r)\rightarrow p(r,\theta)$ for obvious reason.
Restructuring this into a Fourier transform
\begin{equation*}
    f_b(x,y)=\int_{0 }^{\pi}\int_{-\infty}^{\infty} \left(\int_{-\infty}^{\infty} P(r,\theta)e^{i2\pi kr}\;dk\right)\delta(x\cos\theta+y\sin\theta -r)\;dr\;d\theta
\end{equation*}
Applying the CST
\begin{equation*}
    f_b(x,y)=\int_{0 }^{\pi}\int_{-\infty}^{\infty} \left(\int_{-\infty}^{\infty} F(r,\theta)e^{i2\pi kr}\;dk\right)\delta(x\cos\theta+y\sin\theta -r)\;dr\;d\theta
\end{equation*}
Performing the integration over r, we obtain
\begin{equation*}
    f_b(x,y)=\int_{0 }^{\pi}\int_{-\infty}^{\infty} F(r,\theta)\exp \left[ i2 \pi k \left( x \cos \theta+ y \sin \theta \right)  \right] \;dk\;d\theta
\end{equation*}

Now consider 2D Fourier transform
\begin{equation*}
    f(x,y) = \int_{-\infty }^{\infty}\int_{-\infty }^{\infty}F(k_x,k_y)\exp \left[{i 2\pi k (k_x x + k_y y)}\right]\; dk_x \; dk_y
\end{equation*}
or in polar coordinate
\begin{equation*}
    f(x,y) = \int_{0 }^{2\pi}\int_{-\infty }^{\infty}F(k,\theta) \exp \left[{i 2\pi k (x\cos\theta + y\sin\theta)}\right] k \; dk \; d\theta
\end{equation*}
This can be modified to
\begin{equation*}
    f(x,y) = \int_{0 }^{\pi}\int_{-\infty }^{\infty}F(k,\theta) \exp \left[{i 2\pi k (x\cos\theta + y\sin\theta)}\right] |k| \; dk \; d\theta
\end{equation*}
The central slice theorem gives the 1D Fourier transform of the projection at angle $\theta$, so
\begin{equation*}
    f(x,y) = \int_{0 }^{\pi}\int_{-\infty }^{\infty}\mathcal{F} \left\{ p_\theta(r) \right\}  \exp \left[{i 2\pi k (x\cos\theta + y\sin\theta)}\right] |k| \; dk \; d\theta
\end{equation*}
with $\mathcal{F} \left\{ p_\theta(r) \right\}=F(k,\theta)$ as the 1D Fourier transform.
Hence, we can write the expression for laminogram as
\begin{equation*}
    f(x,y) = \int_{0}^{2\pi}\int_{-\infty }^{\infty}\mathcal{F} \left\{ p_\theta(r) \right\} |k| \exp \left[{i 2\pi k (x\cos\theta + y\sin\theta)}\right] \; dk \; d\theta
\end{equation*}
Here $|k|$ arises from the Jacobian of the coordinate transformation, but physicaly it can be understood as the filter such that $\mathcal{F} \left\{ p_\theta(r) \right\} |k|$ is the filtered projection with $H(k)=|k|$ as the projection.

\subsection{Discrete Filtered Backprojection Reconstruction}
Of course digital computers require discrete representations of FBP equation.
Going from continuous space to discrete space is usually straightforward, with $\int \rightarrow \sum $, $dk\rightarrow\Delta k$, $d\theta\rightarrow\Delta \theta$ and $|k|\rightarrow H(k)$ as the ramp filter.

The algorithm is mostly the same as normal FBP.
The only conceptual difference between the continuous and discrete algorithms lies in the filtering step.
In the continuous formulation, filtering is represented by $|k|$,  whereas in the discrete implementation it is performed either as frequency-domain multiplication with $H[k]$ or equivalently as spatial-domain convolution with $h[n]$.
\begin{enumerate}
    \item \textbf{Discrete Fourier transform of each projection.}

          For each sampled projection $p_\theta[n]$, compute its one-dimensional discrete Fourier transform (DFT):
          \[
              P_\theta[k] = \sum_{n=0}^{N-1} p_\theta[n]\, e^{-i 2\pi kn / N}.
          \]

    \item \textbf{Discrete filtering step.}

          The continuous multiplication by $|k|$ becomes a multiplication by a discrete filter $H[k]$:
          \[
              \tilde{P}_\theta[k] = H[k]\, P_\theta[k],
          \]
          where $H[k]$ corresponds to the digital approximation of the ramp filter.
          Equivalently,
          \[
              \tilde{p}_\theta[n] = (h * p_\theta)[n],
          \]
          since, by the convolution theorem
          \[
              \tilde{p}_{\theta}(r)
              = \mathcal{F}^{-1}\{\tilde{P}_{\theta}(k)\}
              = \mathcal{F}^{-1}\{|k|\,P_{\theta}(k)\}
              = \mathcal{F}^{-1}\{|k|\} * \mathcal{F}^{-1}\{P_{\theta}(k)\}
          \]

    \item \textbf{Inverse discrete Fourier transform.}

          Obtain the filtered projection in the spatial domain:
          \[
              \tilde{p}_\theta[n] = \frac{1}{N} \sum_{k=0}^{N-1} \tilde{P}_\theta[k]\, e^{i 2\pi kn / N}.
          \]

    \item \textbf{Discrete backprojection.}

          Reconstruct the image by summing over all projection angles:
          \[
              f[i,j] = \sum_{m=0}^{M-1} \tilde{p}_{\theta_m}(x_i\cos\theta_m + y_j\sin\theta_m)\, \Delta\theta.
          \]
\end{enumerate}

\subsubsection{Ram-Lak filter.}
The practical Ram-Lak filter is band-limited within the Nyquist frequency $k_N=1/2\Delta s$ domain
\[
    H_{\text{RamLak}}(k) =
    \begin{cases}
        |k|, & |k| \le k_N, \\
        0,   & |k| > k_N,
    \end{cases}
\]
The corresponding spatial-domain representation is obtained by inverse Fourier transform:
\[
    h_{\text{RamLak}}(r) =
    \int_{-k_N}^{k_N} |k|\, e^{i2\pi k r}\, dk
    = \frac{k_N \sin(2\pi k_N r)}{\pi r}
    - \frac{1 - \cos(2\pi k_N r)}{2\pi^2 r^2}.
\]
In practice, this discrete sequence is real and even, and can be expressed analytically as
\[
    h_{\text{RamLak}}[m] =
    \begin{cases}
        0,                             & m \text{ even}, \\
        -\dfrac{1}{(\pi n\Delta r)^2}, & m \text{ odd},  \\
        \dfrac{1}{4(\Delta r)^2},      & m = 0.
    \end{cases}
\]

\subsection{CT Number}
The CT number, also known as the Hounsfield Unit (HU), quantifies the relative X-ray attenuation of a material compared to that of water
\begin{equation*}
    \text{CT Number}=K \frac{\mu(x,y)-\mu_\text{water}}{\text{water}}
\end{equation*}
If the scale factor K=1000, then the units of the CT Number is Hounsfield Units (HU).
\end{document}