\documentclass[../../../main.tex]{subfiles}
\begin{document}
\subsection{Introduction}
\begin{enumerate}
    \item \textbf{Attenuation coefficient.} A material property that quantifies how strongly the material absorbs or scatters X-rays. Units: $\text{cm}^{-1}$. It is the physical quantity reconstructed in CT imaging.
    \item \textbf{Intensity.} $I_0$: the incident X-ray intensity before passing through the object (air scan).  $I$: the transmitted X-ray intensity measured by the detector.
    \item \textbf{Projection.} The set of attenuation measurements collected at one fixed rotation angle of the source--detector system. It corresponds mathematically to line integrals of $\mu(x,y)$ along rays oriented at that angle.
    \item \textbf{Ray / Line integral.} Each individual X-ray path through the object. The measured attenuation for one ray is proportional to the integral of $\mu$ along its path.
    \item \textbf{Detector element (bin).} A single sensor in the detector array that records X-ray intensity for one ray. Multiple bins together form the projection profile for a given angle.
    \item \textbf{Projection profile (absorption profile).} The one-dimensional array of attenuation values for all detector bins at a given projection angle. Also called line profile.
    \item \textbf{Sinogram.} The two-dimensional array formed by stacking projection profiles for all angles. Dimension: number of detector bins ($N_s$) $\times$ number of projection angles ($N_\theta$).
    \item \textbf{View / Angle.} One orientation of the X-ray source and detector around the object. Each view corresponds to one projection.
    \item \textbf{Field of view (FOV).} The maximum circular cross-section of the object that can be fully imaged, determined by the geometry of the source and detector.
    \item \textbf{Reconstruction.} The mathematical process of recovering $\mu(x,y)$, i.e. the attenuation map of the object, from the sinogram. Methods include filtered backprojection and iterative reconstruction.
    \item \textbf{Pixel / Voxel.} Pixel: one element of the reconstructed 2D CT image. Voxel: the 3D analogue when slices are stacked.
\end{enumerate}

\subsection{Conventional Radiography and CT}
In conventional radiography, the image represents a 2D projection of the anatomical structures along the direction of the X-ray beam. 
Consequently, no true depth or slice information can be extracted.

In contrast, CT employs a rotating X-ray source and a detector array that acquire multiple projections of the object from different angles. 
These projections are then processed mathematically. 
Each pixel in a CT image corresponds to a specific volumetric element (voxel) with a defined X-ray attenuation coefficient, allowing three-dimensional representation and quantitative measurement of tissue density.

Here are few reason why CT is prefered.
\begin{enumerate}
    \item Improve contrast to enable visualization of different types of soft tissue with X-ray energies. 
    \item Enable 3D visualization.
    \item Visualization of a slice of the anatomy along any imaging plane. 
\end{enumerate}

The reason CT visualization is generaly better tha conventional radiography is because the attenuation coefficients of most soft tissues are very similar at diagnostic X-ray energies, radiographs exhibit poor soft tissue contrast. 
Dense materials such as bone or metal absorb X-rays much more strongly, thereby dominating the image contrast and obscuring the visualization of low-density structures such as blood vessels, muscle, or internal organ boundaries.
Consequently, structures composed primarily of soft tissue—such as the heart, liver, or vasculature—are not well distinguished in conventional X-ray images.
CT overcomes this limitation by reconstructing thin slices, thus eliminating superposition of overlying structures and allows the detection of small differences in attenuation between soft tissues.

\subsection{Beer's Law}
The general form of Beer’s law describes how a beam of radiation is attenuated as it propagates through an absorbing medium.
In three-dimensional space, when the attenuation coefficient is not constant but varies with position, the law generalizes to a path integral form
\begin{equation*}
    I=I_0\exp \left( -\int_S \mu(\mathbf{r })\;ds \right)
\end{equation*}

To obtain a form suitable for tomographic reconstruction, one takes the natural logarithm and rearranges
\begin{equation*}
    \ln\!\left(\frac{I_0}{I}\right) = \int_{S} \mu(\mathbf{r}) \, ds.
\end{equation*}
The left-hand side is experimentally measurable, since $I$ and $I_0$ are detector readings.
The right-hand side is the line integral of the attenuation coefficient along the X-ray path
Defining the projection function $p(r,\theta)$, one obtains
\begin{equation*}
    p_\theta(r)    = \int_{S} \mu(x,y) \, ds,
\end{equation*}
where $\theta$ is the projection angle and $r$ denotes the detector position.

\subsection{Rodon Transform}
The Radon transform describes how a two-dimensional function, such as the attenuation coefficient distribution $\mu(x,y)$, is projected onto a set of line integrals at various angular orientations.

Consider parallel-beam geometry with attenuated intensity of $I_0$.
A new coordinate system is defined by rotating $(x,y)$ counterclockwise over the angle $\theta$, which given by the transformation of
\begin{equation*}
    \begin{bmatrix}
        x \\y
    \end{bmatrix}
    =
    \begin{bmatrix}
        \cos \theta & -\sin \theta \\
        \sin \theta & \cos \theta  \\
    \end{bmatrix}
    \begin{bmatrix}
        r \\s
    \end{bmatrix}
    \quad \text{or }\quad
    \begin{bmatrix}
        r \\s
    \end{bmatrix}
    =
    \begin{bmatrix}
        \cos \theta  & \sin \theta \\
        -\sin \theta & \cos \theta \\
    \end{bmatrix}
    \begin{bmatrix}
        x \\y
    \end{bmatrix}
\end{equation*}
For a fixed angle $\theta$ the measured intensity profile as a function of $r$ is given by
\begin{align*}
    I_\theta(r) & = I_0 \exp \left[ -\sum_s f(x,y)\Delta s \right]                                                                    \\
    I_\theta(r) & = I_0 \exp \left[ -\sum_s f \left( r \cos \theta-s \sin \theta,r \sin \theta+s \cos \theta \right) \Delta s \right]
\end{align*}
For each measured intensity, we can compute the corresponding attenuation line sum.
Each intensity profile is then transformed into an attenuation profile as
\begin{equation*}
    p_\theta(r)=-\ln \left(  \frac{I_0(r )}{I_0}\right)
\end{equation*}
with $p_\theta(r)$ as the projection function of the function $(x,y)$ along the angle $\theta$.
It can also be understood that
\begin{equation*}
    p_\theta(r)=\sum_s f \left( r \cos \theta-s \sin \theta,r \sin \theta+s \cos \theta \right) \Delta s
\end{equation*}
Stacking all the projections $p_\theta(r)$ together results in a 2D data set $p(r,\theta)$ which is called a sinogram.
The transformation of a function $f(x,y)$ into the sinogram $p(r,\theta)$ is called the Radon transform.
\begin{equation*}
    p(r,\theta)=R \left[ f(x,y) \right]=\sum_s f \left( r \cos \theta-s \sin \theta,r \sin \theta+s \cos \theta \right) \Delta s
\end{equation*}

\subsection{Sampling}
In practice, the sinogram $p(r,\theta)$ given by the Rodon transformation becomes $p(n\Delta  r,m\Delta\theta)$ with $M$ rows and $N$ columns.

The minimum number of detector samples required to prevent distortion due to aliasing is called the Nyquist criterion.
It states that if $\Delta s$ is the beam width, then the maximum sampling distance is $\Delta s/2$, or at least two samples per beam width are required. 

A general rule is followed that states that the number of views should be $\pi/2$ times the number of detector samples
For example, if the field of view is 50 cm and the beam width is 1 cm, then 100 detector samples and 150 views are required.

\subsection{Data Acquisition in Translation-Rotation}
\begin{enumerate}
    \item \textbf{Calibration.} Measure the detector intensity without the object for every detector position; denote this as $I_0(r)$.
    \item \textbf{Discretization.} Choose the number of detector samples (translations) per projection $N_s$ and the number of projection angles $N_\theta$. Fix sampling step $\Delta r$ along the detector direction and angular step $\Delta \theta$.
    \item \textbf{Acquisition.} For each angle $\theta_j$, with $j=1,\dots,N_\theta$, perform:
    \begin{enumerate}
        \item Ensure the source–detector pair is at angle $\theta_j$
        \item Translate (or read the detector array) along $r$ axis to obtain measured intensity $I(r_i,\theta_j)$ for each detector samples $r_i$, with $i=1,\dots,N_s$.
        \item Store the corrected detector readings.
    \end{enumerate}
    \item \textbf{Projection profile.} Apply negative logarithm to linearize the Beer–Lambert relation
    \begin{equation*}
        p(r_i,\theta_j)=-\ln \left( \frac{I(r_i,\theta_j)}{I_0(r)} \right) 
    \end{equation*}
    This quantity equals the line integral of the attenuation coefficient along the ray
    \begin{equation*}
            p(r_i,\theta_j)
    = \int_{S} \mu(x,y) \, ds,
    \end{equation*}
    \item \textbf{Sinogram.} Assemble all values $p(r_i,\theta_j)$ into a two-dimensional matrix $S$ with rows for detector positions $\theta_i$ and columns for projection angles $\theta_j$. Visualizing this matrix produces the sinogram. The sinogram matrix has dimensions
    \begin{equation*}
        \dim (S)=N_s\times N_\theta
    \end{equation*}
    where $N_s$ is the number of detector samples per projection and $N_\theta$ is the number of projection angles.
\end{enumerate}

\subsection{Brute Force Reconstruction}
Image reconstruction is the process of estimating an image $f(x,y)$ from from a set of projections $p(r,\theta)$.
With this method, the projection set defines a system of simultaneous linear equations that in theory can be solved using algorithms from linear algebra.

\subsubsection{Example.}
Consider the following 2x2 image with 6 projections
\begin{equation*}
    \begin{matrix}
&w & x &  12 \\
&y & z &  8 \\
13 & 11 & 9 & 7
\end{matrix}
\end{equation*}
These can be organized into a system of equations
\begin{equation*}
\begin{bmatrix}
1 & 1 & 0 & 0 \\
0 & 0 & 1 & 1 \\
1 & 0 & 1 & 0 \\
0 & 1 & 0 & 1 \\
1 & 0 & 0 & 1 \\
0 & 1 & 1 & 0
\end{bmatrix}
\begin{bmatrix}
w \\ x \\ y \\ z
\end{bmatrix}
=
\begin{bmatrix}
12 \\ 8 \\ 11 \\ 9 \\ 7 \\ 13
\end{bmatrix}
\end{equation*}
This is an over-determined system of equations; there are 5 equations and 4 unknowns.
As a consequence, some of the rows and columns are linearly dependent.
We can solve it using normal equation
\begin{equation*}
    \Omega^T \Omega \mathbf{x}=\Omega^T W
\end{equation*}
In python, we can use 
\begin{minted}[breaklines]{python}
Omega_T_Omega = Omega.T @ Omega
Omega_T_W = Omega.T @ W
\end{minted}
to reproduce $\Omega^T \Omega$ and $\Omega^T W$.
Specifically, \verb|Omega.T| is the transpose of Omega, and \verb|@| denotes matrix multiplication.
Also, since the matrix is initialized with \verb|numpy| array, the operation is also handled by \verb|numpy|
\begin{minted}[breaklines]{python}
Omega = np.array([...], dtype=float)
W = np.array([...], dtype=float)
\end{minted}
\end{document}