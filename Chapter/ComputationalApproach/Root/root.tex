\documentclass[../../../main.tex]{subfiles}
\begin{document}
\subsection{Bisection Method}

The bisection method is a numerical algorithm for approximating a root of a continuous function
\[
    f : \mathbb{R} \to \mathbb{R}.
\]
Convergence is guaranteed if $f$ is continuous and $f(a)f(b)<0$.
The convergence is linear, i.e., the error decreases by a factor of $\tfrac{1}{2}$ per iteration.
The method is robust but slower than Newton-Raphson.

\subsubsection{Preconditions.}
Let $f$ be continuous on the interval $[a,b]$.
If
\[
    f(a) \cdot f(b) < 0,
\]
then by the Intermediate Value Theorem, there exists at least one root $\xi \in (a,b)$ such that $f(\xi) = 0$.

\subsubsection{Algorithm.}
Define function $f$ and two point $[x_1$, $x_2]$ as out initial guess.
Compute the midpoint:
\[
    x_t= \frac{x_1+x_2}{2}.
\]
Evaluate $f(x_t)$, then
\begin{enumerate}
    \item If $f(x_t) = 0$, then $x_t$ is the root.
    \item If $f(x_1) f(x_t) < 0$, then set $x_2 = x_1$. This condition implies that the root lies between $[x_1,x_t]$
    \item Otherwise, set $a = c$, since $f(x_1)f(x_t)>0$ imply that the root lies on $[x_t,x_2]$
\end{enumerate}
Repeat until the interval length is sufficiently small:
\[
    |b-a| < \varepsilon
\]
or until
\[
    |f(c)| < \varepsilon,
\]
where $\varepsilon > 0$ is the prescribed tolerance.

\subsubsection{Implementation.}
In python, to calculate $f(x)=x^2-x-6$
\begin{minted}{python}
import numpy as np
def bisec(f,x1,x2,eps=10**(-17)):
    loop=0
    if f(x1)*f(x2)>=0:
        return ValueError("")
    else:
        xt=(x1+x2)/2
        while np.abs(f(xt))>eps:
            if f(x1)*f(xt)<0:
                x2=xt 
            else:
                x1=xt 
            xt=(x1+x2)/2
            loop+=1
        return xt,loop

f= lambda x: x**2-x-6
x1=-1
x2=4
print(bisec(f,x1,x2))
\end{minted}

\subsection{Newton–Raphson Method}
Recall the Taylor series for continuous function
\begin{align*}
    f(x) & =         \frac{1}{n!}(x-a)^n f^{n}(a)              \\
         & =   f(a)+(x-a)f'(a)+\frac{1}{2!}(x-a)^2f''(a)+\dots
\end{align*}
If we use $x=x_r$
\begin{align*}
    f(x_r) & =  f(a)+(x_r-a)f'(a)+\frac{(x_r-a)^2}{2!}f''(a)+\dots=0
\end{align*}
and $a \approx x_r$
\begin{equation*}
    f(a)+(x_r-a)f'(a)=0
\end{equation*}
We obtain the Newton–Raphson iteration
\begin{equation*}
    x_r=a-\frac{f(a )}{f'(a)}
\end{equation*}

\subsubsection{Implementation.}
As shrimple as this
\begin{minted}{python}
def NR(f,df,a,eps=10**(-17)):
loop=0 
xr=0
while np.abs(f(a))>eps:
    xr=a-f(a)/df(a)
    a=xr 
    loop+=1
return xr,loop
\end{minted}
\end{document}