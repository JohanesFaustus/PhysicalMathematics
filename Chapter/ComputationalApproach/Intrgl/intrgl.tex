\documentclass[../../../main.tex]{subfiles}
\begin{document}

\subsection{Rectangular Method}
Rectangular integration approximates the area under a curve by summing the areas of rectangles.
The interval $[a,b]$ is divided into $s$ subintervals of equal width $h$, then the method is expressed as
\begin{equation*}
    \int_{a}^{b} f(x) \; dx \approx h \sum_{k=0}^{n-1} f(a + hk)
\end{equation*}
where
\begin{equation*}
    h=\frac{b-a}{n}
\end{equation*}

\subsubsection{Derivation.}
Rectangular integration is derived by approximating the integral as the sum of the areas of rectangles with height \( f(x_i) \) and width \( h \), yielding
\[
    \int_a^b f(x)\,dx \approx \sum_{i=0}^{n-1} f(x_i)h
\]


\subsection{Trapezoid Method}
The trapezoidal integration method based on replacing the curve over each subinterval with a straight line (a trapezoid).
Let the points be $x_0=a$, $x_1=a+h$,\dots, $x_n=b$
The method is expressed as
\begin{equation*}
    \int_a^b f(x)\,dx \approx \frac{h}{2} \Big[f(x_0) + 2\sum_{i=1 }^{n-1 }f(x_i)+ f(x_n) \Big].
\end{equation*}
with
\begin{equation*}
    h = \frac{b-a}{n}
\end{equation*}

\subsubsection{Derivation.}
Consider a function $f(x)$ defined on $[a,b]$. Divide the interval into $n$ subintervals of equal width
\[
    h = \frac{b-a}{n},
\]
with points $x_0 = a, x_1 = a+h, \dots, x_n = b$ and function values $f(x_i)$.
The area over a single subinterval $[x_i, x_{i+1}]$ can be approximated by a trapezoid:
\[
    \int_{x_i}^{x_{i+1}} f(x)\,dx \approx \frac{h}{2} \left(f(x_i) + f(x_{i+1})\right).
\]
Summing over all subintervals:
\begin{align*}
    \int_a^b f(x)\,dx & \approx \sum_{i=0}^{n-1} \frac{h}{2} \left[f(x_i) + f(x_{i+1})\right]                          \\
                      & =  \frac{h}{2} \Big[f(x_0) + (f(x_1)+f(x_1)) + \dots + (f(x_{n-1})+f(x_{n-1})) + f(x_n) \Big].
\end{align*}
Simplifying the repeated terms for interior points:
\[
    \int_a^b f(x)\,dx \approx \frac{h}{2} \Big[f(x_0) + 2 f(x_1) + 2 f(x_2) + \dots + 2 f(x_{n-1}) + f(x_n) \Big].
\]

\subsection{Simpson's Method}
The Simpson 1/3's rule is given by
\begin{equation*}
    \int_{x_0}^{x_2} f(x)\,dx \approx \frac{h}{3} \left( f(x_{0}) + 4f(x_{1}) + f(x_{2}) \right),
\end{equation*}
where \( h = x_1 - x_0 \).
Another method is called Simpson's 3/8 rule
\begin{equation*}
    \int_{x_0}^{x_3} f(x)\,dx \approx \frac{3h}{8} \left( f(x_{0}) + 3f(x_{1}) + 3f(x_{2}) + f(x_{3}) \right).
\end{equation*}

For a large number of subintervals, Simpsonâ€™s 1/3 and 3/8 rules are extended to composite forms. The interval \([a,b]\) is divided into \(n\) equally spaced subintervals of width \(h\):
\[
    h = \frac{b-a}{n}.
\]
If \(n\) is even, which is required by this method, the {Composite Simpson's 1/3 Rule} is applied:
\[
    \int_a^b f(x)\,dx \approx \frac{h}{3} \left[ f(x_{0}) + 4 \sum_{i=1,3,5,\ldots}^{n-1} f(x_{i}) + 2 \sum_{i=2,4,6,\ldots}^{n-2} f(x_{i}) + f(x_n) \right].
\]
If \(n\) is not a multiple of two, the last three intervals can be evaluated using the {3/8 Rule} to cover the remainder.

\subsubsection{Derivation.}
We demonstrate for the case of 1/3 case, i.e. $n=2$ for the Lagrange interpolation.
Using Lagrange interpolation, the quadratic polynomial passing through the three points is
\begin{equation*}
    P_{2}(x) = f_{0} \frac{(x - x_{1})(x - x_{2})}{(x_{0} - x_{1})(x_{0} - x_{2})} + f_{1} \frac{(x - x_{0})(x - x_{2})}{(x_{1} - x_{0})(x_{1} - x_{2})} + f_{2} \frac{(x - x_{0})(x - x_{1})}{(x_{2} - x_{0})(x_{2} - x_{1})}
\end{equation*}
The integral then simplify
\begin{equation*}
    \int_{x_0}^{x_2}f(x)\;dx\approx
    \int_{x_0}^{x_2}P_2(x)\;dx
\end{equation*}
Now we evaluate the Lagrange interpolation by considering
\begin{equation*}
    x_1 - x_0 = h, \quad x_2 - x_0 = 2h, \quad x_2 - x_1 = h.
\end{equation*}
Now the Lagrange basis turns
\begin{align*}
    L_0(x) & = \frac{(x-x_1)(x-x_2)}{2h^2}, \\
    L_1(x) & = \frac{(x-x_0)(x-x_2)}{-h^2}, \\
    L_2(x) & = \frac{(x-x_0)(x-x_1)}{2h^2},
\end{align*}
Change variable $x = x_0 + t$, $dx = dt$, $t \in [0, 2h]$:
\[
    L_0(t) = \frac{(t-h)(t-2h)}{2h^2}, \quad
    L_1(t) = \frac{t(t-2h)}{-h^2}, \quad
    L_2(t) = \frac{t(t-h)}{2h^2}.
\]
Integrating each basis polynomial:
\[
    \int_0^{2h} L_0(t)\,dt = \frac{h}{3}, \quad
    \int_0^{2h} L_1(t)\,dt = \frac{4h}{3}, \quad
    \int_0^{2h} L_2(t)\,dt = \frac{h}{3}.
\]
Combining the integrals gives
\[
    \int_{x_0}^{x_2} f(x)\,dx \approx f(x_0) \frac{h}{3} + f(x_1) \frac{4h}{3} + f(x_2) \frac{h}{3} = \frac{h}{3} \left[f(x_0) + 4 f(x_1) + f(x_2) \right].
\]

\subsection{Gaussian Quadrature}
For given points $x_i$, solve
\begin{equation*}
    \begin{bmatrix}
        P_0(x_0) & P_0(x_1) & \cdots & P_0(x_N) \\ P_i(x_0) & P_i(x_1) & \cdots & P_i(x_N) \\ \vdots & \vdots & \ddots & \vdots \\ P_N(x_0) & P_N(x_1) & \cdots & P_N(x_N)
    \end{bmatrix}
    \begin{bmatrix}
        w_0 \\ w_1 \\ \vdots \\ w_W
    \end{bmatrix}
    =
    \begin{bmatrix}
        2 \\ 0 \\ \vdots \\ 0
    \end{bmatrix}
\end{equation*}
With the solution $w_i$, then the integral can be approximated as
\begin{equation*}
    \int_{-1 }^{1 }f(x)\;dx \approx \sum_{i=0 }^{N }f(x_i )w_i
\end{equation*}
for arbitrary range
\begin{equation*}
    \int_{a}^{b }f(x)\;dx \approx \frac{b-a}{2}\sum_{i=0 }^{N }f \left[\frac{b-a}{2} x_i + \frac{a+b}{2}\right]
\end{equation*}

\end{document}